{{ define "main" }}
<!-- Hero Section -->
<div class="hero-simple">
  <div class="container">
    <div class="hero-with-icon">
      <div class="hero-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
      </div>
      <h1>Podcast CompartiMOSS</h1>
    </div>
    <p>Conversaciones con expertos de la comunidad sobre tecnologías Microsoft, tendencias y experiencias profesionales.</p>
    <div class="platform-links">
      <a class="platform-link" href="https://podcasts.apple.com/es/podcast/unplugged/id1607356275" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/></svg>
        Apple Podcasts
      </a>
      <a class="platform-link" href="https://open.spotify.com/show/2LjhxhFLOk9UMEULfQjMoc" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
        Spotify
      </a>
      <a class="platform-link" href="https://www.ivoox.com/podcast-unplugged_sq_f11376815_1.html" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
        iVoox
      </a>
      <a class="platform-link" href="https://www.youtube.com/playlist?list=PLh2Rnb9lpMYhHaWJsw2SMW21Pmn1ATxUB" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
        YouTube
      </a>
    </div>
  </div>
</div>

<!-- Episodes List -->
<div class="container-narrow py-12">
  <h2 class="mb-8 text-gray-900">Episodios</h2>

  {{ $feedURL := "https://feeds.ivoox.com/feed_fg_f11376815_filtro_1.xml" }}
  {{ $feed := resources.GetRemote $feedURL }}
  {{ if $feed }}
    {{ $xml := $feed.Content | transform.Unmarshal }}
    <div class="space-y-6" id="episodes-container">
      {{ range $index, $item := first 10 $xml.channel.item }}
      <article class="podcast-episode" data-episode-index="{{ $index }}" data-episode-url="{{ $item.link }}">
        <div class="podcast-episode-content">
          <a class="play-button" aria-label="Ir al episodio" href="{{ $item.link }}" target="_blank" rel="noopener">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
          </a>

          <div class="podcast-episode-info">
            <h3 class="podcast-episode-title">{{ $item.title }}</h3>
            <p class="podcast-episode-description line-clamp-3">{{ $item.description | htmlUnescape | safeHTML }}</p>

            <div class="podcast-episode-meta">
              <div class="podcast-episode-meta-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                <span>{{ time $item.pubDate | time.Format "2 January 2006" }}</span>
              </div>
              {{ if index $item "itunes:duration" }}
              <div class="podcast-episode-meta-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                <span>{{ index $item "itunes:duration" }}</span>
              </div>
              {{ end }}
            </div>
          </div>
        </div>
      </article>
      {{ end }}
    </div>

  {{ else }}
    <div class="alert alert-error">
      <p>No se pudo cargar el feed de podcast. Intenta más tarde.</p>
    </div>
  {{ end }}

  <!-- Subscription CTA -->
  <div class="cta-box mt-12">
    <h3>Suscríbete al Podcast</h3>
    <p>No te pierdas ningún episodio. Suscríbete en tu plataforma favorita de podcasts.</p>
    <div class="cta-buttons">
      <a href="https://podcasts.apple.com/es/podcast/unplugged/id1607356275" class="btn btn-pink" target="_blank" rel="noopener">Apple Podcasts</a>
      <a href="https://open.spotify.com/show/2LjhxhFLOk9UMEULfQjMoc" class="btn btn-orange" target="_blank" rel="noopener">Spotify</a>
      <a href="https://www.ivoox.com/podcast-unplugged_sq_f11376815_1.html" class="btn btn-gray" target="_blank" rel="noopener">iVoox</a>
      <a href="https://www.youtube.com/playlist?list=PLh2Rnb9lpMYhHaWJsw2SMW21Pmn1ATxUB" class="btn btn-gray" target="_blank" rel="noopener">YouTube</a>
    </div>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const episodes = document.querySelectorAll('.podcast-episode');

    episodes.forEach((episode) => {
      const url = episode.dataset.episodeUrl;
      if (!url) return;

      // Make whole card clickable
      episode.style.cursor = 'pointer';
      episode.addEventListener('click', () => {
        window.open(url, '_blank');
      });

      // Prevent bubbling from the play button so it keeps its own behavior
      const playButton = episode.querySelector('.play-button');
      if (playButton) {
        playButton.addEventListener('click', (event) => {
          event.stopPropagation();
        });
      }
    });
  });
</script>
{{ end }}
